import java.sql.*;

public class DatabaseCommunicator {
	
	private static Connection getDatabaseCommunicator()
	{
		Connection dbConnection = null;
		try
		{
			Class.forName("org.sqlite.JDBC");
		}
		catch (ClassNotFoundException e)
		{
			System.out.println(e.getMessage());
		}
		
		try
		{
			String dbURL = "jdbc:sqlite:main.sqlite"; //TODO: Insert URL (jdbc:sqlite:<somename>.sqlite)
			dbConnection = DriverManager.getConnection(dbURL);
			return dbConnection;
		}
		catch( SQLException e)
		{
			System.out.println(e.getMessage());
		}
		return dbConnection;
	}
	
	//TODO: SQL: Make request. Requires pre-formed statements (i.e. a pre determined statement for each SQL request).
	public static ResultSet testMakeRequest(String query) throws SQLException
	{
		Connection dbConnection = null;
		Statement statement = null;
		ResultSet resultSet = null;
		
		//query = "SELECT * FROM testTable;";
		
		try
		{
			dbConnection = getDatabaseCommunicator();
			statement = dbConnection.createStatement();
			System.out.println(query);
			resultSet = statement.executeQuery(query);
			//System.out.println(resultSet.getRow());
			while(resultSet.next())
			{
				System.out.println(resultSet.getInt(1)+" "+resultSet.getInt(2));
			}
			return resultSet;
		}
		catch (SQLException e)
		{
			System.out.println(e.getMessage());
		}
		finally
		{
			
			if(resultSet != null)
				resultSet.close();
			if(resultSet != null)
				statement.close();
			if(dbConnection != null)
				dbConnection.close();
			
		}
		return resultSet;
	}
	
	public static Connection setupNewAppointmentDatabase(String appointmentBookName)
	{
		Connection dbConnection = DatabaseCommunicator.getDatabaseCommunicator();
		Statement statement = null;
		
		try
		{
			statement.execute("CREATE TABLE STATEMENT GOES HERE");
		}
		catch(SQLException e)
		{
			System.out.println(e.getMessage());
		}
		
		return dbConnection;
	}
}
